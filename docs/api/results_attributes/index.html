<!DOCTYPE html>
<html><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My New Hugo Site</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital@1&display=swap" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <link rel="stylesheet" href="/OpenSR-test/css/style.css">
</head><body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary nav nav_principal fixed-top">
  <div class="container-fluid div-nav" style="width: 60%;">
    <a class="navbar-brand fs-4 a" href="/" style="margin-left: 30px; font-weight: 700; color: #d6d6d6;">
      <img src="/OpenSR-test/imgs/logo_opensrtest.png" style="height:30px;">
      OpenSR test
    </a>
  </div>

  
  <div class="container-fluid" style="width: 15%; margin-left: 30px;">
    <form class="d-flex search-form" role="search">
      <div class="input-group">
        <span class="input-group-text"><i class="fas fa-search"></i></span>
        <input class="form-control" type="search" placeholder="Search" aria-label="Search">
      </div>
    </form>
  </div>
  

  <div class="div" style="width: 15%;  margin-left: 55px;">
    <a href="https://github.com/ESAOpenSR/opensr-test" title="Go to repository" class="md-source"
      data-md-component="source">
      <div class="md-source__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
          <path
            d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z">
          </path>
        </svg>
      </div>
      <div class="md-source__repository" data-md-state="done" style="color: #fff;">
        OpenSR test
        <ul class="md-source__facts">
          <li class="md-source__fact md-source__fact--stars">
            <i class="far fa-star"></i> 2
          </li>
          <li class="md-source__fact md-source__fact--forks">
            <i class="fas fa-code-branch"></i> 0
          </li>

        </ul>
      </div>
    </a>
  </div>
  <div class="div2" style="width: 10%;">
    <p><i class="far fa-moon" style="color: #ffffff; font-size: 1.4em; margin-top: 13px;"></i>
    </p>
  </div>
</nav>

  <main>
    <div class="container-fluid">
      <div class="row" style="margin-top: 70px;">

        
        <div style="width: 23%;">
          <style>
  .aside {
    max-height: 80vh;
     
    overflow-y: auto;
     
  }

  .nested-nav {
    list-style-type: none;
     
  }
</style>

<aside class="aside">
  <div class="sidebar-sticky aside">
    <ul class="nav flex-column custom-nav">
      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse">
          <strong>Home</strong>
        </a>
        <div class="collapse show" id="homeSection">
          <ul class="nested-nav" style="margin-left: -8px;">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/">
                Home
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/home/contributing">
                Contributing
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/home/code_of_conduct">
                Code of Conduct
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/home/changelog">
                Changelog
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/home/license" style="margin-bottom: 15px;">
                License
              </a>
            </li>
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse">
          <strong>Properties</strong>
        </a>
        <div class="collapse show" id="propertiesSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/properties/main" style="margin-bottom: 15px;">
                Main
              </a>
            </li>
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse" href="#apiSection">
          <strong>API</strong>
        </a>
        <div class="collapse show" id="apiSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/api/model_parameters">
                Model parameters
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/api/setup_method">
                Setup method
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/api/compute_method">
                Compute method
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/api/summary_method">
                Summary method
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/api/results_attributes" style="margin-bottom: 20px;">
                Results attributes
              </a>
            </li>
          </ul>
        </div>
      </li>





      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse" href="#datasetSection">
          <strong>Dataset</strong>
        </a>
        <div class="collapse show" id="datasetSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/dataset/home">
                Home
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/dataset/naip">
                NAIP
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/dataset/spot">
                SPOT
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/dataset/venµs" style="margin-bottom: 15px;">
                Venµs
              </a>
            </li>
          </ul>
        </div>
      </li>







      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse" href="#metricsSection">
          <strong>Metrics</strong>
        </a>
        <div class="collapse show" id="metricsSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/metrics/consistency">
                Consistency metrics
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/metrics/distance">
                Distance metrics
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/metrics/correctness" style="margin-bottom: 15px;">
                Correctness metrics
              </a>
            </li>
          </ul>
        </div>
      </li>





      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse" href="#examplesSection">
          <strong>Examples</strong>
        </a>
        <div class="collapse show" id="examplesSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/examples/pytorch_models">
                PyTorch models
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/examples/tensorflow_models">
                TensorFlow models
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/examples/diffuser_models">
                Diffuser models
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/examples/multi_image_sr_model">
                Multi-image SR model
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/examples/create_correctness_animation"
                style="margin-bottom: 15px;">
                Create Correctness animation
              </a>
            </li>
          </ul>
        </div>
      </li>



      <li class="nav-item">
        <a class="nav-link" id="subtitle" data-toggle="collapse" href="#benchmarksSection">
          <strong>Benchmarks</strong>
        </a>
        <div class="collapse show" id="benchmarksSection">
          <ul class="nested-nav">
            <li class="nav-item">
              <a class="nav-link" href="/OpenSR-test/benchmarks">
                Benchmarks
              </a>
            </li>
          </ul>
        </div>
      </li>
    </ul>
  </div>
</aside>
        </div>

        
        <div style="width: 54%; margin-top: 40px; margin-bottom: 10px;" id="dynamic-content">
<h1 id="heading"></h1>
<h2 id="the-results-attribute">The <code>results</code> Attribute</h2>
<p>The <code>results</code> attribute encapsulate all the metrics calculated at the <code>agg_method</code> level, along with the intermediate results produced by the <code>opensr-test</code> test. It organizes the output into four principal categories: <em>consistency</em>, <em>distance</em>, <em>correctness</em>, and <em>auxiliary</em>. The following example illustrates how to retrieve the outpus from the <code>results</code> attribute:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Import necessary libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> opensr_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate sample LR, HR, and SR images</span>
</span></span><span style="display:flex;"><span>lr <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">64</span>)  <span style="color:#75715e"># Low Resolution image</span>
</span></span><span style="display:flex;"><span>hr <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">256</span>)  <span style="color:#75715e"># High Resolution image</span>
</span></span><span style="display:flex;"><span>sr <span style="color:#f92672">=</span> torch<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">256</span>, <span style="color:#ae81ff">256</span>)  <span style="color:#75715e"># Super Resolution image</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize the Metrics object</span>
</span></span><span style="display:flex;"><span>metrics <span style="color:#f92672">=</span> opensr_test<span style="color:#f92672">.</span>Metrics()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Setup the evaluation environment</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>setup(lr<span style="color:#f92672">=</span>lr, sr<span style="color:#f92672">=</span>sr, hr<span style="color:#f92672">=</span>hr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compute the metrics</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>compute()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accessing Consistency Metrics</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>consistency
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accessing Distance Metrics post SR Harmonization</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>distance
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Accessing Correctness Metrics</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>correctness
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accessing Intermediate Results</span>
</span></span><span style="display:flex;"><span>metrics<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>auxiliary
</span></span></code></pre></div><p>Except the auxiliary field, the spatial resolution of all the results is determined by the <code>agg_method</code> parameter. For instance, if <code>agg_method</code> is set to &ldquo;patch&rdquo; with a patch_size of 32, then each metric in the results attribute will contain values aggregated over patches of size H/32 x W/32.</p>
<details>
  <summary><b>consistency</b></summary>
    The consistency metrics within `opensr-test` play a crucial role in evaluating the harmony between LR and SR images prior to SR harmonization (SRharm). These metrics are calculated after resampling the SR images to match the dimensions of the LR (SRdown). There are three key metrics in this category: *reflectance*, *spectral*, and *spatial*.  
  <summary><b>reflectance</b></summary>
    This metric evaluates how well the SR image reflects the norm values of the LR image. The calculation of reflectance consistency utilizes the method defined by the reflectance_method parameter.  
  <summary><b>spectral</b></summary>
    This metric assesses the similarity in spectral characteristics between the LR and SR images. The computation of spectral consistency leverages the angle distance specified in the spectral_method parameter. This allows for a detailed comparison of the spectral profiles of the images, ensuring that the SR image preserves the original spectral properties of the LR image.
  <summary><b>spatial</b></summary>
    The spatial consistency metric is computed by calculating the difference between the matching points identified in the LR and HR images. This process evaluates the spatial alignment and structural integrity of the SR image compared to the LR image. If the agg_method parameter is set to pixel or patch, the grid is calculated applying a simple kernel interpolation method.
</details>
<details>
    <summary><b>distance</b></summary>
    distance metrics in `opensr-test` permit measure how far the SR image is from the LR and HR images. These metrics are computed post-harmonization (SRharm) to reduce the potential spatial and spectral bias introduced by the SR model. There are three distance metrics: <i>sr_lr</i>, <i>sr_hr</i> and <i>hr_lr</i>.
    <summary><b>sr_to_lr (SRharm - LR Distance)</b></summary>
    This metric quantifies the distance between SRharm and the LR image. It serves as an indicator of how close the SR image is to the LR image. The LR is upsampled (LRup) to the dimensions of the HR image using the method defined by the upsample_method parameter. We strongly advise opting for a method that does not require parameter tuning, such as bilinear interpolation or other similar techniques. This is crucial to prevent the introduction of hallucination artifacts, which can significantly bias the experimental results.
    <summary><b>sr_to_hr (SRharm - HR Distance)</b></summary>
    This metric measures the distance between the harmonized SR image (SRharm) and the HR image. It is essential for measure if the high-frequency details introduced by the SR model are consistent with the HR image (improvement) or if they are artificial (hallucination).
    <summary><b>lr_to_hr (HR - LR Distance)</b></summary>
    This metric calculates the distance between the HR and LR images. Although it doesn't directly involve the SR image, it offers a baseline understanding of the initial discrepancies between the HR and LR images, which can be useful for context and comparison.
</details>
<details>
  <summary><b>correctness</b></summary>
  The correctness metrics in `opensr-test` are crucial assessments conducted after the SR harmonization process and the evaluation of the triple distance. These metrics encompass four categories: <i>improvement</i>, <i>omission</i>, <i>hallucination</i>, and <i>classification</i>. All the correctness metrics are designed such that values closer to 0 indicate that the pixel, patch, or image is nearer to its respective target space.
  <summary><b>improvement</b></summary>
  The improvement matrix quantifies the extent of improvement space. It is a matrix of dimensions HxW. The `im_score` parameter, defined in the `compute` method, acts as a modulator, allowing for fine-tuning of the space. 
  <summary><b>omission</b></summary>
  The omission matrix, on the other hand, evaluates the extent of the omission space. This matrix provides insights into areas where the SR process might have failed to replicate crucial details from the HR image. 
  <summary><b>hallucination</b></summary>
  The hallucination matrix measures the extent of artificial details or 'hallucinations' introduced in the SR image. The definition of the improvement and omission spaces conditions the determination of the hallucination space.
  <summary><b>classification</b></summary>
  The classification matrix is computed by applying a np.argmin function across the aforementioned correctness matrices. This matrix forms the basis for categorizing each pixel into one of the three classes: improvement, omission, and hallucination.
</details>
<details>
  <summary><b>auxiliary</b></summary>
  The auxiliary results in opensr-test comprise a set of intermediate outputs generated during the execution of the compute method. These results are instrumental in understanding the internal workings and transformations applied during the computation process. There are four key auxiliary results: <b>sr_harm</b>, <b>lr_to_hr</b>, <b>matching_points_lr</b>, and <b>matching_points_hr</b>.
  <summary><b>sr_harm</b></summary>
  This is the SR product post-harmonization. The harmonization pipeline is influenced by the harm_apply_spectral and harm_apply_spatial parameters. When both parameters are enabled (set to True), the SR image undergoes a two-step enhancement: first, the reflectance values are corrected via histogram matching with the HR image; subsequently, spatial alignment is performed, aligning the SR image with the HR image based on the settings defined in the spatial_features and spatial_matcher parameters.
  <summary><b>lr_to_hr</b></summary>
  This represents the LR image resampled to match the dimensions of the HR image. In the absence of a specific upsample_method set during the setup phase, the lr_to_hr result is achieved using a classic method - bilinear interpolation complemented by an anti-aliasing kernel filter.
  <summary><b>matching_points_lr</b></summary>  
  These are the points of correspondence identified between the LR and HR images. This points help in understanding the spatial relationship and alignment between these two different tensor resolutions.
  <summary><b>matching_points_hr</b></summary>  
  These are the points of correspondence identified between the SRharm and HR images. It provides insights into how well the SR image aligns with the HR image after the harmonization process.
</details>


        </div>

        
        
        <aside class="aside2" style="width: 23%;">
          <div class="sidebar-sticky aside">
            
            <h6 class="text-muted" style="margin-bottom: 0; height: 30px;">Table of contents</h6>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#the-results-attribute">The <code>results</code> Attribute</a></li>
  </ul>
</nav>
            
          </div>
        </aside>

        

      </div>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.7.2/dist/js/bootstrap.bundle.min.js"></script>



  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      
      if (localStorage.getItem('dark-mode') === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelector('.fa-moon').classList.add('fa-sun');
        document.querySelector('.fa-moon').classList.remove('fa-moon');
      }
    });

    document.querySelector('.fa-moon, .fa-sun').addEventListener('click', function () {
      document.body.classList.toggle('dark-mode');
      this.classList.toggle('fa-moon');
      this.classList.toggle('fa-sun');

      
      localStorage.setItem('dark-mode', document.body.classList.contains('dark-mode'));
    });

    document.addEventListener('DOMContentLoaded', function () {
      
      const tocLinks = document.querySelectorAll('.aside2 #TableOfContents a');

      tocLinks.forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault(); 

          const targetId = this.getAttribute('href').substring(1);
          const target = document.getElementById(targetId);

          if (target) {
            
            const top = target.getBoundingClientRect().top + window.pageYOffset - 70; 

            window.scrollTo({ top: top, behavior: 'smooth' });
          }
        });
      });
    });

  </script>

  
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

</body>

</html>





