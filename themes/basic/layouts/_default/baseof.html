<!DOCTYPE html>
<html>
{{- partial "head.html" . -}}

<body>
  {{ partial "nav.html" . }}

  <main>
    <div class="container-fluid">
      <div class="row" style="margin-top: 70px;">

        <!-- Left Navigation -->
        <div style="width: 23%;">
          {{ partial "partials/left_nav.html" . }}
        </div>

        <!-- Main Content -->
        <div style="width: 54%; margin-top: 40px; margin-bottom: 10px;" id="dynamic-content">
          {{- block "main" . }}{{- end }}
        </div>

        <!-- Right Navigation -->
        {{ if .TableOfContents }}
        <aside class="aside2" style="width: 23%;">
          <div class="sidebar-sticky aside">
            {{ if and .TableOfContents (ne (default true .Params.showtoc) false) }}
            <h6 class="text-muted" style="margin-bottom: 0; height: 30px;">Table of contents</h6>
            {{ .TableOfContents }}
            {{ end }}
          </div>
        </aside>

        {{ else }}
        {{ end }}

      </div>
    </div>
  </main>

  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.7.2/dist/js/bootstrap.bundle.min.js"></script>



  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      // Al cargar la página, verifica si el modo oscuro está activado en el almacenamiento local
      if (localStorage.getItem('dark-mode') === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelector('.fa-moon').classList.add('fa-sun');
        document.querySelector('.fa-moon').classList.remove('fa-moon');
      }
    });

    document.querySelector('.fa-moon, .fa-sun').addEventListener('click', function () {
      document.body.classList.toggle('dark-mode');
      this.classList.toggle('fa-moon');
      this.classList.toggle('fa-sun');

      // Guarda el estado del modo oscuro en el almacenamiento local
      localStorage.setItem('dark-mode', document.body.classList.contains('dark-mode'));
    });

    document.addEventListener('DOMContentLoaded', function () {
      // Selecciona todos los enlaces de la tabla de contenidos
      const tocLinks = document.querySelectorAll('.aside2 #TableOfContents a');

      tocLinks.forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault(); // Previene el comportamiento predeterminado de saltar directamente al enlace

          const targetId = this.getAttribute('href').substring(1);
          const target = document.getElementById(targetId);

          if (target) {
            // Calcula la posición deseada para el desplazamiento
            const top = target.getBoundingClientRect().top + window.pageYOffset - 70; // -30 para ajustar el offset deseado

            window.scrollTo({ top: top, behavior: 'smooth' });
          }
        });
      });
    });

    //right_nav
    document.addEventListener('DOMContentLoaded', () => {
      // Cambia el color al hacer clic
      document.querySelectorAll('.aside2 .nav-link').forEach(link => {
        link.addEventListener('click', function () {
          document.querySelectorAll('.aside2 .nav-link').forEach(navLink => navLink.classList.remove('current-right-link'));
          this.classList.add('current-right-link');
        });
      });

      // Cambia el color según la posición del scroll
      window.addEventListener('scroll', () => {
        const sections = document.querySelectorAll('section'); // Asegúrate de que tus secciones tengan un id.
        let currentSectionId = '';

        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          if (window.scrollY >= sectionTop - 10) {
            currentSectionId = section.getAttribute('id');
          }
        });

        document.querySelectorAll('.aside2 .nav-link').forEach(link => {
          link.classList.remove('current-right-link');
          if (link.getAttribute('href') === `#${currentSectionId}`) {
            link.classList.add('current-right-link');
          }
        });
      });
    });



    //left_nav
    document.addEventListener('DOMContentLoaded', () => {
      // Resalta el enlace actual basado en el almacenamiento local
      const currentLink = localStorage.getItem('currentLink');
      if (currentLink) {
        const activeLink = document.querySelector(`.nav-link[href="${currentLink}"]`);
        if (activeLink) {
          activeLink.classList.add('current-link');
        }
      } else {
        // Resalta el enlace basado en la ruta actual si no hay nada en el almacenamiento local
        const path = window.location.pathname;
        document.querySelectorAll('.nav-link').forEach(link => {
          if (link.getAttribute('href') === path) {
            link.classList.add('current-link');
          }
        });
      }

      // Añade un listener a todos los enlaces
      document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function () {
          // Elimina la clase 'current-link' de todos los enlaces
          document.querySelectorAll('.nav-link').forEach(navLink => navLink.classList.remove('current-link'));

          // Añade la clase 'current-link' al enlace clickeado y guárdalo en el almacenamiento local
          this.classList.add('current-link');
          localStorage.setItem('currentLink', this.getAttribute('href'));
        });
      });
    });



  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js">
  </script>


</body>
<script>
  MathJax.typeset();
</script>


</html>





<!--
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const navLinks = document.querySelectorAll('.custom-nav .nav-link');

    // Función para verificar si un elemento está en la vista
    const isElementInViewport = (el) => {
      const rect = el.getBoundingClientRect();
      return (
        rect.top >= 0 &&
        rect.left >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
        rect.right <= (window.innerWidth || document.documentElement.clientWidth)
      );
    };

    // Función para manejar el desplazamiento
    const handleScroll = () => {
      let found = false;

      navLinks.forEach(link => {
        const sectionId = link.getAttribute('href').substring(1);
        const section = document.getElementById(sectionId);

        if (section && isElementInViewport(section) && !found) {
          found = true;
          navLinks.forEach(l => l.classList.remove('active'));
          link.classList.add('active');

          // Aquí puedes agregar la lógica para cambiar el contenido del archivo .md
          // por ejemplo, llamando a una función que maneje la carga dinámica del contenido
          loadContent(link.getAttribute('data-content'));
        }
      });
    };

    // Función para cargar dinámicamente el contenido
    const loadContent = (contentUrl) => {
      // Aquí debes implementar la lógica para cargar el contenido desde el servidor
      // Puedes usar fetch, jQuery.ajax, o la biblioteca que prefieras
      // Luego, actualiza el contenido de tu elemento #dynamic-content
      // por ejemplo, usando innerHTML o insertAdjacentHTML

      // Ejemplo usando fetch:
      fetch(contentUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error(`Error loading content: ${response.statusText}`);
          }
          return response.text();
        })
        .then(data => {
          document.getElementById('dynamic-content').innerHTML = data;
        })
        .catch(error => console.error(error));
    };

    // Llama a la función handleScroll cuando ocurre un evento de desplazamiento
    window.addEventListener('scroll', handleScroll);

    // Llama a la función handleScroll después de que el DOM esté completamente cargado
    handleScroll();

    // Agrega el evento de clic a cada enlace
    navLinks.forEach(link => {
      link.addEventListener('click', function (event) {
        event.preventDefault();

        // Remueve 'active' de todos los enlaces
        navLinks.forEach(l => l.classList.remove('active'));

        const sectionId = this.getAttribute('href').substring(1);
        const section = document.getElementById(sectionId);

        if (section) {
          // Ajusta la posición del scroll para animar el desplazamiento
          window.scrollTo({
            top: section.offsetTop,
            behavior: 'smooth',
          });

          // Agrega 'active' solo al enlace clicado
          this.classList.add('active');

          // Carga dinámicamente el contenido del archivo .md
          loadContent(this.getAttribute('data-content'));
        }
      });
    });
  });
</script> -->